"use strict";var app=angular.module("wedding",["ngRoute","ngSanitize","ngDialog"]);app.constant("API_URL","http://ferdeapi.hostzi.com/api/v1/");app.config(function(a){a.when("/",{templateUrl:"../index.html",})});app.directive("owlCarousel",function(){return{restrict:"E",transclude:false,link:function(a){a.initCarousel=function(e){var c={};var b=a.$eval($(e).attr("data-options"));for(var d in b){c[d]=b[d];if(d=="navigation"){if(c[d]){c.navigationText=['<i class="fa fa-chevron-circle-left" style="margin-top: 5px;" aria-hidden="true"></i>','<i class="fa fa-chevron-circle-right" style="margin-top: 5px;" aria-hidden="true"></i>']}}}$(e).owlCarousel(c)}}}});app.directive("owlCarouselItem",function(){return{restrict:"A",transclude:false,link:function(b,a){if(b.$last){b.initCarousel(a.parent())}}}});app.directive("imageonload",function(){return{restrict:"A",link:function(c,b,a){c.loading=function(e,d){$("#"+e).hide();$("#"+d).removeAttr("style")};b.bind("load",function(){c.$apply(a.imageonload)});b.bind("error",function(){c.$apply(a.imageonload)})}}});app.factory("apiService",function(d,a,c){var b=c;return{getGuest:function(){return d.get(b+"guest").then(function(e){var f=e.data;if(f==null){return a.reject("Invalid data")}return f})},uploadImage:function(f){var e=false;var g=new FormData();g.append("file",f[0]);return d.post(b+"uploadimage",g,{headers:{"Content-Type":undefined},transformRequest:angular.identity}).then(function(h){var i=h.data;if(i==null){return a.reject("Invalid data")}return i})},saveGuest:function(e){return d({method:"POST",url:b+"guest",data:$.param(e),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(f){var g=f.data;if(g==null){return a.reject("Invalid data")}return g})}}});app.controller("HomeController",function(a,d,c,b){a.bride_name="Della";a.groom_name="Fery";a.duedate="July / 7th / 2017"});app.controller("StoryController",function(a){a.bride_fullname="Difliyatul Isna Alvionita";a.groom_fullname="Fery Yundara Putera"});app.controller("GalleryController",function(a){a.gallery=[{image:"images/gallery/gallery-1.jpg",thumb:"images/gallery/gallery-1_thumb.jpg"},{image:"images/gallery/gallery-2.jpg",thumb:"images/gallery/gallery-2_thumb.jpg"},{image:"images/gallery/gallery-3.jpg",thumb:"images/gallery/gallery-3_thumb.jpg"},{image:"images/gallery/gallery-4.jpg",thumb:"images/gallery/gallery-4_thumb.jpg"},{image:"images/gallery/gallery-5.jpg",thumb:"images/gallery/gallery-5_thumb.jpg"},{image:"images/gallery/gallery-6.jpg",thumb:"images/gallery/gallery-6_thumb.jpg"},{image:"images/gallery/gallery-7.jpg",thumb:"images/gallery/gallery-7_thumb.jpg"},{image:"images/gallery/gallery-8.jpg",thumb:"images/gallery/gallery-8_thumb.jpg"},{image:"images/gallery/gallery-9.jpg",thumb:"images/gallery/gallery-9_thumb.jpg"}]});app.controller("PeopleController",function(a){a.people=[{image:"images/bridemaid.jpg",name:"Lisa Hornet",status:"Bridemaid"},{image:"images/best-man.jpg",name:"Dan Hornet",status:"Best man"},{image:"images/brides-mother.jpg",name:"Anna Parker",status:"Brides mother"},{image:"images/grooms-mother.jpg",name:"Sarah Benson",status:"Grooms mother"},{image:"images/brides-father.jpg",name:"Philip Parker",status:"Brides father"},{image:"images/grooms-father.jpg",name:"Lisa Hornet",status:"Grooms father"}]});app.controller("EventController",function(a){a.agenda=[{image:"images/masjid.jpg",type:"Ijab Qobul",time:"8:00 - 10:00",description:"Donec sit amet nibh ullamcorper, mattis elit at, venenatis ex. Proin justo nisi, vulputate mollis tincidunt ut, elementum non dolor."},{image:"images/hotel.jpg",type:"Walimah",time:"20:00 - 22:00",description:"Donec sit amet nibh ullamcorper, mattis elit at, venenatis ex. Proin justo nisi, vulputate mollis tincidunt ut, elementum non dolor."}]});app.controller("GuestController",function(a,c,b){b.getGuest().then(function(d){a.guest=angular.copy(d)});a.loadImg=function(d){return d}});app.controller("RsvpController",function(b,g,a,d,e,c,f){b.form={};b.Images={};b.submitButtonText="Submit";b.submitted=false;b.save=function(i,k){b.msgError=undefined;b.submitted=true;var h=b.formChecker(i,k);if(h){b.submitButtonText="";var j={attend:(k.attend==undefined?true:k.attend),name:k.name,email:k.email,phone:k.phone,relation:(k.relation=="other"?k.other+" of "+k.withWhom:k.relation),message:k.message,image:""};if(b.Images.length>0){e.uploadImage(b.Images).then(function(l){if(l.success){j.image=l.filename;e.saveGuest(j).then(function(m){if(m.success){f.open({template:'<h4 style="text-align:center">Your wish has been sent!</h4><button class="submit button lila" onclick="window.location.reload()">Ok</button>',plain:true,preCloseCallback:function(n){window.location.reload()}});b.submitButtonText="Submit"}else{b.submitButtonText="Submit";b.msgError=m.message;b.form={};b.form.attend=true}})}})}else{e.saveGuest(j).then(function(l){if(l.success){f.open({template:'<h4 style="text-align:center">Your wish has been sent!</h4><button class="submit button lila" onclick="window.location.reload()">Ok</button>',plain:true,preCloseCallback:function(m){window.location.reload()}});b.submitButtonText="Submit"}else{b.submitButtonText="Submit";b.msgError=l.message;b.form={};b.form.attend=true}})}}};b.formChecker=function(k,o){b.formErrorMessage=[];var h=true;var l=/[0-9() +-]/g;var m=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;var n=o.phone;var j=(b.Images.length>0?b.Images[0].name:null);if(!k){b.formErrorMessage.push(a.trustAsHtml("please, fill all the <b>required</b> * fields !"));h=false}if(!l.test(n)&&n!=undefined){b.formErrorMessage.push(a.trustAsHtml("phone number format invalid! please refer to this format <strong>0811223223XXX</strong> !"));h=false}if(b.Images.length>0){if(b.Images[0].size>1000000){b.formErrorMessage.push(a.trustAsHtml("image size more than <strong>1MB</strong> !"));h=false}}if(o.message!=undefined&&o.message.length<100){b.formErrorMessage.push(a.trustAsHtml("messages should be at least <strong>100 character</strong> !"));h=false}if(!m.test(o.email)&&o.email!=undefined){b.formErrorMessage.push(a.trustAsHtml("email format invalid, please refer to this format <strong>ferde@info.com</strong> !"));h=false}if(j!=null){var i=j.substr(j.lastIndexOf(".")+1);if(i=="jpg"||i=="png"){}else{b.formErrorMessage.push(a.trustAsHtml("file extention is not <strong>.jpg</strong> or <strong>.png</strong>!"));h=false}}return h};b.setImages=function(h){b.Images=h}});
